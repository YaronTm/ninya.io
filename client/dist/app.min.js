angular.module("StackWho",["ngAnimate","rx"]),function(){var a={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},b=a[typeof window]&&window||this,c=a[typeof exports]&&exports&&!exports.nodeType&&exports,d=a[typeof module]&&module&&!module.nodeType&&module,e=(d&&d.exports===c&&c,a[typeof global]&&global);!e||e.global!==e&&e.window!==e||(b=e);var f=Rx.Observable,g=f.prototype,h=function(a){return"function"==typeof a},i=angular.module("rx",[]);i.factory("rx",function(a){if(!a.Rx)throw new Error("Rx is not defined!");return a.Rx}),i.factory("observeOnScope",function(a){return function(b,c,d){return a.Observable.create(function(a){function e(b,c){a.onNext({oldValue:c,newValue:b})}return b.$watch(c,e,d)})}}),g.safeApply=function(a,b){return b=h(b)?b:function(){},this.doAction(function(c){a.$$phase||a.$root.$$phase?b(c):a.$apply(function(){b(c)})})},i.config(["$provide",function(a){a.decorator("$rootScope",["$delegate",function(a){return Object.defineProperty(a.constructor.prototype,"$toObservable",{value:function(a,b){var c=this;return Rx.Observable.create(function(d){function e(a,b){d.onNext({oldValue:b,newValue:a})}return c.$watch(a,e,b)})},enumerable:!1}),a}])}])}.call(this);var Lexer=function(){var a={},b="a-zA-Z0-9ÀÁÂÃÄÅàáâãäåÒÓÔÕÖØòóôõöøÈÉÊËèéêëÇçÌÍÎÏìíîïÙÚÛÜùúûüÿÑñ",c=new RegExp("location:(((?!answers:)["+b+", ])+)","i"),d=new RegExp("answers:(((?!location:)["+b+", ])+)","i");return a.tokenize=function(a){var b=a.match(c),e=a.match(d),f={locations:[],answerTags:[]},g=function(a){return a&&a.trim().toLowerCase()},h=function(a){return a&&a.length>0};return f.locations=b&&b.length>1&&b[1].split(",").map(g).filter(h)||[],f.answerTags=e&&e.length>1&&e[1].split(",").map(g).filter(h)||[],f},a};"undefined"!=typeof module&&(module.exports=Lexer),angular.module("StackWho").config(["$locationProvider",function(a){a.html5Mode(!0)}]).controller("AppController",["$scope","$http","$location","$sce","config","ToggleButtonModel",function(a,b,c,d,e,f){"use strict";var g=new Lexer,h=g.tokenize(c.search().cmd||c.search().q||"");a.serverRendered=serverRendered,a.searchStringLocation=h.locations.join(","),a.searchStringTags=h.answerTags.join(","),a.displayUsers=[],a.$sce=d,a.faq=f({CLOSE_TEXT:"Got it. Close the FAQ.",OPEN_TEXT:"Wonder what this is? Read the FAQ."}),a.examples=f({CLOSE_TEXT:"Close the Examples.",OPEN_TEXT:"Check out some example queries."}),a.createQueryLink=function(){var a=l().replace(/\s/g,"%20");return encodeURIComponent("http://www.ninya.io/?q="+a)};var i=location.origin.indexOf("ninya.io")>-1||location.origin.indexOf("stackwho.herokuapp.com")>-1?location.origin:e.backendEndpoint,j=i+"/users",k=function(a){var c={searchString:a},d=Rx.Observable.fromPromise(b({url:j,method:"GET",params:c})).select(function(a){return a.data.users});return d},l=function(){var b="";return a.searchStringLocation.length>0&&(b+="location: "+a.searchStringLocation),a.searchStringTags.length>0&&(b+=" answers: "+a.searchStringTags),b},m=Rx.Observable.merge(a.$toObservable("searchStringLocation"),a.$toObservable("searchStringTags"));m.skip(2).subscribe(function(){a.serverRendered=!1}),m.where(function(){return!a.serverRendered&&(a.searchStringLocation.length>0||a.searchStringTags.length>0)}).select(l).throttle(400).distinctUntilChanged().doAction(function(){a.displayUsers=[],a.loading=!0}).select(k).switchLatest().safeApply(a,function(b){a.loading=!1,a.displayUsers=b}).subscribe()}]),angular.module("StackWho").factory("ToggleButtonModel",[function(){"use strict";return function(a){var b={};return b.open=!1,angular.extend(b,a),b.text=b.OPEN_TEXT,b.toggle=function(){b.open=!b.open,b.text=b.open?b.CLOSE_TEXT:b.OPEN_TEXT},b}}]),angular.module("StackWho").constant("config",{backendEndpoint:"http://localhost:5000"});