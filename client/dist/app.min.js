angular.module("StackWho",["ngAnimate","rx"]),function(){var a={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},b=a[typeof window]&&window||this,c=a[typeof exports]&&exports&&!exports.nodeType&&exports,d=a[typeof module]&&module&&!module.nodeType&&module,e=(d&&d.exports===c&&c,a[typeof global]&&global);!e||e.global!==e&&e.window!==e||(b=e);var f=Rx.Observable,g=f.prototype,h=function(a){return"function"==typeof a},i=angular.module("rx",[]);i.factory("rx",function(a){if(!a.Rx)throw new Error("Rx is not defined!");return a.Rx}),i.factory("observeOnScope",function(a){return function(b,c,d){return a.Observable.create(function(a){function e(b,c){a.onNext({oldValue:c,newValue:b})}return b.$watch(c,e,d)})}}),g.safeApply=function(a,b){return b=h(b)?b:function(){},this.doAction(function(c){a.$$phase||a.$root.$$phase?b(c):a.$apply(function(){b(c)})})},i.config(["$provide",function(a){a.decorator("$rootScope",["$delegate",function(a){return Object.defineProperty(a.constructor.prototype,"$toObservable",{value:function(a,b){var c=this;return Rx.Observable.create(function(d){function e(a,b){d.onNext({oldValue:b,newValue:a})}return c.$watch(a,e,b)})},enumerable:!1}),a}])}])}.call(this),angular.module("StackWho").config(["$locationProvider",function(a){a.html5Mode(!0)}]).controller("AppController",["$scope","$http","$location","$sce","config",function(a,b,c,d,e){"use strict";var f=function(){var a={},b=/location:(((?!answers:)[-A-Za-z0-9, ])+)/i,c=/answers:(((?!location:)[-A-Za-z0-9, ])+)/i;return a.tokenize=function(a){var d=a.match(b),e=a.match(c),f={locations:[],answerTags:[]},g=function(a){return a&&a.trim().toLowerCase()},h=function(a){return a&&a.length>0};return f.locations=d&&d.length>1&&d[1].split(",").map(g).filter(h)||[],f.answerTags=e&&e.length>1&&e[1].split(",").map(g).filter(h)||[],f},a},g=new f,h=g.tokenize(c.search().cmd||c.search().q||"");a.serverRendered=serverRendered,a.searchStringLocation=h.locations.join(","),a.searchStringTags=h.answerTags.join(","),a.displayUsers=[],a.$sce=d,a.faq={text:"",open:!1,CLOSE_TEXT:"Got it. Close the FAQ.",OPEN_TEXT:"Wonder what this is? Read the FAQ."},a.faq.text=a.faq.OPEN_TEXT,a.toggleFaq=function(){a.faq.open=!a.faq.open,a.faq.text=a.faq.open?a.faq.CLOSE_TEXT:a.faq.OPEN_TEXT},a.examples={text:"",open:!1,CLOSE_TEXT:"Close the Examples.",OPEN_TEXT:"Check out some example queries."},a.examples.text=a.examples.OPEN_TEXT,a.toggleExamples=function(){a.examples.open=!a.examples.open,a.examples.text=a.examples.open?a.examples.CLOSE_TEXT:a.examples.OPEN_TEXT},a.createQueryLink=function(){var a=l().replace(/\s/g,"%20");return encodeURIComponent("http://www.ninya.io/?q="+a)};var i=location.origin.indexOf("ninya.io")>-1||location.origin.indexOf("stackwho.herokuapp.com")>-1?location.origin:e.backendEndpoint,j=i+"/users",k=function(a){var c={searchString:a},d=Rx.Observable.fromPromise(b({url:j,method:"GET",params:c})).select(function(a){return a.data.users});return d},l=function(){var b="";return a.searchStringLocation.length>0&&(b+="location: "+a.searchStringLocation),a.searchStringTags.length>0&&(b+=" answers: "+a.searchStringTags),b},m=Rx.Observable.merge(a.$toObservable("searchStringLocation"),a.$toObservable("searchStringTags"));m.skip(2).subscribe(function(){a.serverRendered=!1}),m.where(function(){return!a.serverRendered&&(a.searchStringLocation.length>0||a.searchStringTags.length>0)}).select(l).throttle(400).distinctUntilChanged().doAction(function(){a.displayUsers=[],a.loading=!0}).select(k).switchLatest().safeApply(a,function(b){a.loading=!1,a.displayUsers=b}).subscribe()}]),angular.module("StackWho").constant("config",{backendEndpoint:"http://localhost:5000"});